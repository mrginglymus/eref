{% extends 'app.html' %}

{% block progress %}
{% include 'progress.html' %}
{% endblock %}

{% from 'macros.html' import text_input, saveandnext, select_input, applicant_info %}

{% block content %}


<div class="row p-a m-t well">
  {{ applicant_info('Applicant name', 'Miss Sarah Williams<br><a href="mailto:fred@blogs.com">fred@blogs.com</a>') }}
  {{ applicant_info('Application number', '12345678') }}
  {{ applicant_info('Application date', '18 August 2015') }}
  {{ applicant_info('Course', 'MPhil in Development Studies<br><a href="/" class="secondary-cta">Prospectus link</a>') }}
</div>

<div class="alert alert-info alert-top" role="alert">
  <div class="row">
    <div class="col-md-4">
      <span class="fa fa-circle-o"></span>
      <span>Required fields:</span>
    </div>
    <div class="col-md-8">

    </div>
  </div>
</div>

<div class="row">
  <div class="col-md-6 p-x">
    <h2>Your Details</h2>
    {{ select_input('Title', 'title', ['', 'Professor', 'Herr doktor doktor']) }}
    {{ text_input('Forename(s)', 'firstname') }}
    {{ text_input('Surname(s)', 'lastname') }}
    {{ text_input('Telephone', 'telephone', false, false) }}
  </div>
  <div class="col-md-6 p-x">
    <h2>How you know the applicant</h2>
    <p>Please give details of your job at the time you knew the applicant.</p>
    {{ text_input('Job Title', 'jobtitle') }}
    {{ text_input('Institution/Organisation', 'institution') }}
    {{ text_input('Department', 'department', false, false) }}
    {{ text_input('City', 'city') }}
    {{ text_input('Country', 'country') }}
    {{ text_input('Relationship with applicant', 'relationship', 'e.g. Supervisor, Line Manager, Tutor') }}
    {{ text_input('Known applicant for', 'knownfor', 'Please provide an estimate of the time period you knew the applicant (e.g. October 2013 to July 2014, September 2015 to present)') }}
  </div>
</div>
{{ saveandnext('../reference') }}

<script type="text/javascript">
$(function()  {
  mandatory = $('input, select').filter('[data-mandatory]');
  var refresh = function() {
    mandatory_done = mandatory.filter(function() {return $(this).val() != ""});
    mandatory_not_done = mandatory.filter(function() {return $(this).val() === ""});
    if (mandatory.length == mandatory_done.length) {
      $('.alert-info .col-md-8').html('You have completed all required fields and will be able to submit when all other pages are complete.').prev().children('.fa').removeClass('fa-circle-o').addClass('fa-check-circle-o');
    } else {
      $('.alert-info .col-md-8').html('You have completed <strong>' + mandatory_done.length + '</strong> of <strong>' + mandatory.length + '</strong> required questions (marked with a blue circle). You will be able to save but unable to submit the reference until you have completed all mandatory fields on this and other pages').prev().children('.fa').removeClass('fa-check-circle-o').addClass('fa-circle-o');
    }
    mandatory_done.prev().children('span.fa').removeClass('fa-circle-o').addClass('fa-check-circle-o');
    mandatory_not_done.prev().children('span.fa').css('color', '#0072cf').removeClass('fa-check-circle-o').addClass('fa-circle-o');
  }
  refresh();
  mandatory.change(function() {
    refresh();
  });
  mandatory.keyup(function() {
    refresh();
  });
});
</script>
{% endblock %}
